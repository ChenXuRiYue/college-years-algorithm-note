### 苹果二叉树

[苹果二叉树](https://www.luogu.com.cn/problem/P2015)

##### 简介

```txt
以一颗以1为根部的树，每一条边上，都有一些苹果。
现在打算减去一定数量的边，问所有方案中，保留苹果数的最大值。
```

##### 分析

```txt
定义一个子状态为：
f[i][j]//在以i为根的子树中减去j个树枝所失去的最小苹果。
因为是完全二叉树。除了叶子，这些左右子树一定存在。
假设我们知道了，两个子树的各个量的值，就可以迁移。

f[i][j]=min(f[son1][k]+f[son2][j-k],f[i][j])
总的复杂度，应该是n^3.
```

#### code

```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
const int maxn = 100 + 10;
const int inf = 1e9;

int w[maxn][maxn]; //表示某一条树枝上的苹果树。
int f[maxn][maxn];
int n, m;
int sum[maxn]; //记录有向下有多少个个顶点。包括自己。
vector<vector<int>> g;

void dfs(int now, int fa)
{
    sum[now]++;
    if (g[now].size() == 1)
        return;
    int rec[2];
    int ttt = 0;
    for (auto i : g[now])
    {
        if (i != fa)
            rec[ttt++] = i, dfs(i, now);
    }
    int u = rec[0], v = rec[1];
    sum[now] += sum[u] + sum[v]; //更新。
    //这里处理一下。增加一个含义。
    f[v][sum[v]] = f[v][sum[v] - 1] + w[now][v];
    f[u][sum[u]] = f[u][sum[u] - 1] + w[now][u];
    for (int i = 0; i <= sum[u]; i++)
        for (int j = 0; j <= sum[v]; j++)
            f[now][i + j] = min(f[now][i + j], f[u][i] + f[v][j]);
    // f[now][sum[u]] = min(f[now][sum[u]], f[now][sum[u] - 1] + w[now][u]);
    // f[now][sum[v]] = min(f[now][sum[v]], f[now][sum[v] - 1] + w[now][v]);
    // f[now][sum[u] + sum[v]] = f[v][sum[v] - 1] + f[u][sum[u] - 1] + w[now][v] + w[now][u];
}

int main()
{
    ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);

    cin >> n >> m;
    g.resize(n + 1);
    for (int i = 1; i <= n; i++)
        for (int j = 1; j <= n; j++)
            f[i][j] = inf;
    int ans = 0;
    for (int i = 1; i < n; i++)
    {
        int a, b, c;
        cin >> a >> b >> c;
        ans += c;
        w[a][b] = c;
        w[b][a] = c;
        g[a].push_back(b);
        g[b].push_back(a);
    }
    dfs(1, 0);
    // for (int i = 1; i <= n; i++)
    //     cout << f[3][i] << ' ';
    // cout << '\n';
    // for (int i = 1; i <= n; i++)
    //     cout << sum[i] << ' ';
    cout << ans - f[1][n-1-m] << '\n';
}
```





