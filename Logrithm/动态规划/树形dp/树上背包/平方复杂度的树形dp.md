参考：

[树上背包的上下界优化 - ouuan - 博客园 (cnblogs.com)](https://www.cnblogs.com/ouuan/p/BackpackOnTree.html)

#### 简介

在某一些背景之中，树形dp的复杂度看似$N^3$但是经过优化之后复杂度事实上会是$O(N^2)$。这篇笔记，总结一些平方的树形dp。包括复杂度证明、经典问题、实现关键。

#### 问题引入

树上背包（选课问题等）

现在看这些问题的共性：

1. 状态设计上形如$f_{u,k}$，根节点与子节点之间的状态合并的复杂度为：$O(N^2)$。
2. 指标函数中，第二个维度的值域和子树的节点数有关。注意控制两个dp数组的大小，就可以整体上控制复杂度为$O(N^2)$

#### 证明如下：

几个角度：

1. 研究整体的转移过程：得到一个公式
2. 然后从子节点开始看。利用数学上（和平方>平方和的性质）得到最小规模子树的处理复杂度。
3. 往上递归证明得到根节点的复杂度。
